{#
/**
 * @file
 * Theme override for the corporate European Commission Standardised footer block.
 *
 * Available variables:
 * - site_owner: Site's owner.
 * - site_specific_footer: renderable array for site specific footer links
 * - corporate_footer: renderable array for corporate footer links
 * @see ./module/contrib/oe_corporate_blocks/templates/oe-corporate-blocks-ec-footer.html.twig
 */
#}

{# Section 2 will contain first general link and the social links. #}

{% set _section_2 = [] %}

{% set section = site_specific_footer.other_links|first %}

{% set _section_2 = _section_2|merge([{
  'title': section.links ? section.label,
  'links': section.links ? ecl_footer_links(section.links),
  'section_id': 2,
  'title_class_name': 'ecl-footer-standardised__title--separator',
}]) %}

{% set _section_2 = _section_2|merge([{
  'title': site_specific_footer.social_links ? 'Follow us on'|t,
  'links': site_specific_footer.social_links ? ecl_footer_links(site_specific_footer.social_links),
  'section_id': 2,
  'list_class_name': 'ecl-footer-standardised__list--inline',
  'title_class_name': 'ecl-footer-standardised__title--separator',
}]) %}

{# Section 3 will contain the remaining general links. #}

{% set _section_3 = [] %}

{% for section in site_specific_footer.other_links|slice(1) %}

  {% set _section_3 = _section_3|merge([{
    'title': section.links ? section.label,
    'links': section.links ? ecl_footer_links(section.links),
    'section_id': 3,
    'title_class_name': 'ecl-footer-standardised__title--separator',
  }]) %}

{% endfor %}

{# Section 2 and 3 needs minimum 2 items to display. #}

{% set _section_3 = _section_3|merge([{
  'section_id': 3,
  'title_class_name': 'ecl-footer-standardised__title--separator',
}]) %}

{% set _section_2 = _section_2|merge([{
  'section_id': 2,
  'title_class_name': 'ecl-footer-standardised__title--separator',
}]) %}

{% set _sections = [
  {
    'title': {
      'link': {
        'label': site_specific_footer.site_identity,
        'path': url('<front>'),
      }
    },
    'description': site_owner ? 'This site is managed by the @name'|t({'@name': site_owner}),
    'section_id': 1,
  },
  _section_2,
  _section_3,
  {
    'section_id': 6,
    'list_class_name': 'ecl-footer-standardised__list--condensed',
  },
  {
    'title': {
      'link': {
        'label': corporate_footer.corporate_site_link.label,
        'path': corporate_footer.corporate_site_link.href,
      },
    },
    'section_id': 7,
  },
  {
    'links': ecl_footer_links(corporate_footer.service_navigation),
    'section_id': 8,
  },
  {
    'links': ecl_footer_links(corporate_footer.legal_navigation),
    'section_id': 9,
  },
] %}

{% include '@ecl-twig/footer-standardised' with {
  'sections': _sections,
} %}
